# GitHub Copilot Instructions

このファイルは、GitHub Copilotがコードを生成する際の指針を提供します。

## コーディングスタイル

### 一般原則
- **簡潔さ**: 冗長なコードを避け、読みやすさを優先する
- **一貫性**: プロジェクト全体で統一されたスタイルを維持する
- **明確性**: 複雑なロジックには適切なコメントを追加する
- **保守性**: 将来の変更を容易にする設計を心がける

### 命名規則
- **変数・関数**: camelCase（例: `getUserData`, `isValid`）
- **定数**: UPPER_SNAKE_CASE（例: `MAX_RETRY_COUNT`, `API_ENDPOINT`）
- **クラス**: PascalCase（例: `UserManager`, `DataProcessor`）
- **ファイル**: kebab-case（例: `user-service.js`, `data-utils.js`）
- **意味のある名前**: 単一文字や省略形を避け、目的を明確に示す

### コメント
- **最小限**: 自己説明的なコードを書き、必要な場合のみコメントを追加
- **Why over What**: 「何をしているか」ではなく「なぜそうしているか」を説明
- **更新**: コード変更時にはコメントも更新する
- **TODO/FIXME**: 未完了のタスクや既知の問題には明確にマーク

```javascript
// Good: なぜそうするかを説明
// リトライ回数を制限してAPIの過負荷を防ぐ
const MAX_RETRY_COUNT = 3;

// Bad: 何をしているかだけ説明
// 最大リトライ回数を設定
const MAX_RETRY_COUNT = 3;
```

## エラーハンドリング

### 原則
- **早期リターン**: エラーケースは早めに処理して抜ける
- **具体的なエラー**: エラーメッセージは問題の特定と解決に役立つ内容にする
- **ログ記録**: 重要なエラーは必ずログに記録する
- **リソース解放**: エラー発生時もリソースを適切に解放する

```javascript
// Good: 早期リターンとエラーログ
async function processData(data) {
  if (!data) {
    console.error('Data is null or undefined');
    return null;
  }
  
  try {
    return await transform(data);
  } catch (error) {
    console.error('Failed to transform data:', error);
    throw error;
  }
}
```

## セキュリティ

### 必須事項
- **機密情報**: APIキー、パスワード、トークンをコードに直接記述しない
- **環境変数**: 機密情報は環境変数やシークレット管理ツールで管理
- **入力検証**: ユーザー入力は常に検証・サニタイズする
- **依存関係**: 既知の脆弱性がないか定期的にチェックする

```javascript
// Bad: APIキーをハードコーディング
const apiKey = "sk-1234567890abcdef";

// Good: 環境変数から取得
const apiKey = process.env.API_KEY;
```

## パフォーマンス

### 最適化の指針
- **早すぎる最適化を避ける**: まず動作するコードを書き、必要に応じて最適化
- **測定**: パフォーマンス改善前に必ず計測する
- **非同期処理**: I/O処理は非同期で実行し、ブロッキングを避ける
- **キャッシュ**: 頻繁にアクセスされる不変データはキャッシュする

## テスト

### テスト方針
- **テスト可能な設計**: 依存関係を注入可能にし、モックやスタブを使いやすくする
- **単体テスト**: 個々の関数やメソッドの動作を検証
- **カバレッジ**: 重要なロジックは必ずテストでカバーする
- **エッジケース**: 正常系だけでなく異常系やエッジケースもテスト

## ドキュメント

### README
- **概要**: プロジェクトの目的と主要機能を簡潔に説明
- **セットアップ**: インストールと初期設定の手順を明記
- **使用方法**: 基本的な使い方の例を提供
- **トラブルシューティング**: よくある問題と解決方法を記載

### API/関数ドキュメント
- **パラメータ**: 型と説明を明記
- **戻り値**: 返される値の型と意味を説明
- **例外**: 発生しうる例外を記載
- **使用例**: 実際の使用例を提供

## Git コミット

### コミットメッセージ
- **フォーマット**: `type: subject` の形式を使用
- **type**: feat, fix, docs, style, refactor, test, chore など
- **subject**: 変更内容を簡潔に（50文字以内推奨）
- **body**: 必要に応じて詳細な説明を追加

```
feat: ユーザー認証機能を追加

- JWT トークンによる認証を実装
- ログイン/ログアウトエンドポイントを追加
- セッション管理機能を実装
```

### コミット単位
- **小さく保つ**: 1つのコミットは1つの論理的な変更に限定
- **動作する状態**: 各コミットでコードは動作可能な状態を保つ
- **レビュー容易性**: レビューしやすい単位でコミット

## コードレビュー

### レビュー観点
- **ロジック**: コードが意図通りに動作するか
- **可読性**: 他の開発者が理解しやすいか
- **保守性**: 将来の変更が容易か
- **テスト**: 適切にテストされているか
- **セキュリティ**: セキュリティリスクがないか

### フィードバック
- **建設的**: 改善案を具体的に提示
- **敬意**: 相手の意図を尊重し、丁寧な言葉遣いで
- **学び**: レビューは双方向の学習機会として活用

## 依存関係管理

### ライブラリ選定
- **必要性**: 本当に必要か検討する（不要な依存を避ける）
- **保守状況**: 活発にメンテナンスされているか確認
- **ライセンス**: プロジェクトと互換性のあるライセンスか確認
- **サイズ**: バンドルサイズへの影響を考慮

### 更新
- **定期的な更新**: セキュリティパッチやバグ修正を適用
- **破壊的変更**: メジャーバージョンアップ時は影響範囲を確認
- **テスト**: 更新後は必ずテストを実行

## プロジェクト固有の追加指示

この下に、プロジェクト固有の指示を追加してください：

---

- 環境はCloudflare上のサービス（Worker, D1, KV）を使用しています。これを考慮したコード生成を行ってください。
